<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Referral Functions Test Suite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css">
    <style>
        .spin {
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .test-section {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .test-result {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
        }
        
        .success { background-color: #d1e7dd; color: #0f5132; }
        .error { background-color: #f8d7da; color: #842029; }
        .info { background-color: #d1ecf1; color: #055160; }
        
        #qrcode canvas {
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-12">
                <div class="text-center mb-4">
                    <h1 class="display-6 mb-3">üß™ Referral Functions Test Suite</h1>
                    <p class="lead text-muted">Test all functionality from the referrals page</p>
                </div>
                
                <!-- Browser Support Info -->
                <div class="test-section">
                    <h4 class="mb-3">üìä Browser Support Information</h4>
                    <div id="browserInfo" class="test-result info"></div>
                </div>

                <!-- Copy Function Test -->
                <div class="test-section">
                    <h4 class="mb-3">üìã Copy Function Test</h4>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="referralCode" 
                               value="http://127.0.0.1:8001/register?refferal_code=testuser" readonly>
                        <button class="btn btn-light" type="button" id="copyButton" onclick="handleCopyLink()">
                            <i class="ri-file-copy-line me-1"></i> Copy
                        </button>
                    </div>
                    <button class="btn btn-outline-primary btn-sm" onclick="testCopyFunction()">
                        <i class="ri-play-line me-1"></i> Run Copy Test
                    </button>
                    <div id="copyResult" class="test-result"></div>
                </div>

                <!-- WhatsApp Share Test -->
                <div class="test-section">
                    <h4 class="mb-3">üí¨ WhatsApp Share Test</h4>
                    <button class="btn btn-success" onclick="shareOnWhatsApp()">
                        <i class="ri-whatsapp-line me-1"></i> Test WhatsApp Share
                    </button>
                    <button class="btn btn-outline-success btn-sm" onclick="testWhatsAppFunction()">
                        <i class="ri-play-line me-1"></i> Run WhatsApp Test
                    </button>
                    <div id="whatsappResult" class="test-result"></div>
                </div>

                <!-- Telegram Share Test -->
                <div class="test-section">
                    <h4 class="mb-3">‚úàÔ∏è Telegram Share Test</h4>
                    <button class="btn btn-info" onclick="shareOnTelegram()">
                        <i class="ri-telegram-line me-1"></i> Test Telegram Share
                    </button>
                    <button class="btn btn-outline-info btn-sm" onclick="testTelegramFunction()">
                        <i class="ri-play-line me-1"></i> Run Telegram Test
                    </button>
                    <div id="telegramResult" class="test-result"></div>
                </div>

                <!-- QR Code Generation Test -->
                <div class="test-section">
                    <h4 class="mb-3">üî≤ QR Code Generation Test</h4>
                    <button class="btn btn-primary" onclick="generateQR()">
                        <i class="ri-qr-code-line me-1"></i> Generate QR Code
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testQRFunction()">
                        <i class="ri-play-line me-1"></i> Run QR Test
                    </button>
                    <div id="qrResult" class="test-result"></div>
                    <div id="qrPreview" class="mt-3"></div>
                </div>

                <!-- All Functions Test -->
                <div class="test-section">
                    <h4 class="mb-3">üöÄ Run All Tests</h4>
                    <button class="btn btn-warning btn-lg" onclick="runAllTests()">
                        <i class="ri-flask-line me-1"></i> Run Complete Test Suite
                    </button>
                    <div id="allTestsResult" class="test-result"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="qrModalLabel">Test QR Code</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <div id="qrcode" class="mb-3"></div>
                    <p class="text-muted">QR code generated for testing purposes</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="downloadQR()">Download QR</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- QR Code Generator with fallback -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js" 
            onerror="console.warn('Primary QRCode library failed, trying fallback...');"></script>
    <script>
        // Fallback QRCode library loader
        if (typeof QRCode === 'undefined') {
            console.warn('QRCode library not loaded, attempting fallback...');
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js';
            script.onerror = function() {
                console.error('All QRCode libraries failed to load');
                window.qrCodeLibraryFailed = true;
            };
            document.head.appendChild(script);
        }
        
        // Test results tracking
        let testResults = {
            copy: null,
            whatsapp: null,
            telegram: null,
            qr: null
        };

        // Enhanced copy function (exact same as in referrals page)
        function handleCopyLink() {
            console.log('üöÄ Copy button clicked');
            
            const referralCode = document.getElementById('referralCode');
            const copyButton = document.getElementById('copyButton');
            
            if (!referralCode || !copyButton) {
                console.error('‚ùå Required elements not found', {
                    referralCode: !!referralCode,
                    copyButton: !!copyButton
                });
                showNotification('‚ùå Copy button error - please refresh the page', 'error');
                return;
            }
            
            const referralCodeValue = referralCode.value.trim();
            
            if (!referralCodeValue) {
                console.error('‚ùå No referral code to copy');
                showNotification('‚ùå No referral link available', 'error');
                return;
            }
            
            const originalButtonContent = copyButton.innerHTML;
            console.log('üìã Attempting to copy:', referralCodeValue);
            
            // Disable button and show loading state
            copyButton.disabled = true;
            copyButton.innerHTML = '<i class="ri-loader-line spin me-1"></i> Copying...';
            
            // Enhanced button reset function
            function resetButton(success = false, message = '') {
                const delay = success ? 2500 : 3500;
                const buttonClass = success ? 'btn-success' : 'btn-danger';
                const iconClass = success ? 'ri-check-line' : 'ri-error-warning-line';
                const text = success ? 'Copied!' : 'Try Again';
                
                // Show success/error state
                copyButton.innerHTML = `<i class="${iconClass} me-1"></i> ${text}`;
                copyButton.classList.remove('btn-light', 'btn-success', 'btn-danger');
                copyButton.classList.add(buttonClass);
                
                // Reset to original state after delay
                setTimeout(() => {
                    copyButton.innerHTML = originalButtonContent;
                    copyButton.classList.remove(buttonClass);
                    copyButton.classList.add('btn-light');
                    copyButton.disabled = false;
                }, delay);
            }
            
            // Method 1: Modern Clipboard API (preferred)
            if (navigator.clipboard && window.isSecureContext) {
                console.log('üîí Using secure Clipboard API');
                
                navigator.clipboard.writeText(referralCodeValue)
                    .then(() => {
                        console.log('‚úÖ Clipboard API success');
                        showNotification('‚úÖ Referral link copied successfully!', 'success');
                        resetButton(true);
                        testResults.copy = true;
                    })
                    .catch((err) => {
                        console.warn('‚ö†Ô∏è Clipboard API failed:', err.message);
                        console.log('üîÑ Attempting fallback methods...');
                        tryFallbackMethods();
                    });
            } else {
                const reason = !navigator.clipboard ? 'Clipboard API not available' : 'Insecure context (HTTP)';
                console.log('‚ö†Ô∏è ' + reason + ', using fallback methods');
                tryFallbackMethods();
            }
            
            // Enhanced fallback methods
            function tryFallbackMethods() {
                let methodWorked = false;
                
                // Method 2: execCommand with hidden textarea
                try {
                    console.log('üìù Trying execCommand with textarea');
                    
                    const textarea = document.createElement('textarea');
                    textarea.value = referralCodeValue;
                    textarea.style.position = 'fixed';
                    textarea.style.top = '-9999px';
                    textarea.style.left = '-9999px';
                    textarea.style.opacity = '0';
                    textarea.setAttribute('readonly', '');
                    
                    document.body.appendChild(textarea);
                    textarea.focus();
                    textarea.select();
                    textarea.setSelectionRange(0, textarea.value.length);
                    
                    const success = document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    if (success) {
                        console.log('‚úÖ execCommand textarea method succeeded');
                        showNotification('‚úÖ Referral link copied to clipboard!', 'success');
                        resetButton(true);
                        methodWorked = true;
                        testResults.copy = true;
                        return;
                    }
                } catch (err) {
                    console.log('‚ùå execCommand textarea failed:', err.message);
                }
                
                if (!methodWorked) {
                    console.log('üìã All automatic methods failed');
                    resetButton(false);
                    testResults.copy = false;
                }
            }
        }

        // Share functions (exact same as in referrals page)
        function shareOnWhatsApp() {
            console.log('üü¢ WhatsApp share clicked');
            try {
                const referralCodeEl = document.getElementById('referralCode');
                if (!referralCodeEl) {
                    console.error('‚ùå Referral code element not found');
                    showNotification('‚ùå Error: Cannot find referral link', 'error');
                    testResults.whatsapp = false;
                    return;
                }
                
                const referralCode = referralCodeEl.value?.trim();
                if (!referralCode) {
                    console.error('‚ùå No referral code available');
                    showNotification('‚ùå Error: No referral link available', 'error');
                    testResults.whatsapp = false;
                    return;
                }
                
                const message = `üéâ Join me on this amazing trading platform! Use my referral link to get started: ${referralCode}`;
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                
                console.log('üì± Opening WhatsApp with URL:', whatsappUrl);
                // In test mode, we won't actually open the window but will log success
                console.log('‚úÖ WhatsApp URL generated successfully');
                showNotification('‚úÖ WhatsApp sharing URL generated successfully!', 'success');
                testResults.whatsapp = true;
                
                // Uncomment the line below for actual sharing
                // window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
            } catch (error) {
                console.error('‚ùå WhatsApp share failed:', error);
                showNotification('‚ùå Error sharing to WhatsApp: ' + error.message, 'error');
                testResults.whatsapp = false;
            }
        }

        function shareOnTelegram() {
            console.log('üîµ Telegram share clicked');
            try {
                const referralCodeEl = document.getElementById('referralCode');
                if (!referralCodeEl) {
                    console.error('‚ùå Referral code element not found');
                    showNotification('‚ùå Error: Cannot find referral link', 'error');
                    testResults.telegram = false;
                    return;
                }
                
                const referralCode = referralCodeEl.value?.trim();
                if (!referralCode) {
                    console.error('‚ùå No referral code available');
                    showNotification('‚ùå Error: No referral link available', 'error');
                    testResults.telegram = false;
                    return;
                }
                
                const message = `üöÄ Join me on this incredible trading platform! Sign up using my referral link: ${referralCode}`;
                const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(referralCode)}&text=${encodeURIComponent(message)}`;
                
                console.log('üì± Opening Telegram with URL:', telegramUrl);
                // In test mode, we won't actually open the window but will log success
                console.log('‚úÖ Telegram URL generated successfully');
                showNotification('‚úÖ Telegram sharing URL generated successfully!', 'success');
                testResults.telegram = true;
                
                // Uncomment the line below for actual sharing
                // window.open(telegramUrl, '_blank', 'noopener,noreferrer');
            } catch (error) {
                console.error('‚ùå Telegram share failed:', error);
                showNotification('‚ùå Error sharing to Telegram: ' + error.message, 'error');
                testResults.telegram = false;
            }
        }

        // QR Generation function (exact same as in referrals page)
        function generateQR() {
            console.log('üî≤ QR Code generation clicked');
            try {
                const referralCodeEl = document.getElementById('referralCode');
                if (!referralCodeEl) {
                    console.error('‚ùå Referral code element not found');
                    showNotification('‚ùå Error: Cannot find referral link', 'error');
                    testResults.qr = false;
                    return;
                }
                
                const referralCode = referralCodeEl.value?.trim();
                if (!referralCode) {
                    console.error('‚ùå No referral code available');
                    showNotification('‚ùå Error: No referral link available', 'error');
                    testResults.qr = false;
                    return;
                }
                
                // Check if QRCode library is loaded
                if (typeof QRCode === 'undefined') {
                    console.error('‚ùå QRCode library not loaded');
                    showNotification('‚ùå Error: QR Code library not loaded. Please refresh the page.', 'error');
                    testResults.qr = false;
                    return;
                }
                
                const qrContainer = document.getElementById('qrcode');
                if (!qrContainer) {
                    console.error('‚ùå QR code container not found');
                    showNotification('‚ùå Error: QR code container not found', 'error');
                    testResults.qr = false;
                    return;
                }
                
                // Clear previous QR code and show loading
                qrContainer.innerHTML = '<div class="text-center p-3"><i class="ri-loader-line spin fs-24 text-primary"></i><br><small class="text-muted">Generating QR code...</small></div>';
                
                console.log('üìã Generating QR code for:', referralCode);
                
                // Generate new QR code
                try {
                    QRCode.toCanvas(referralCode, {
                        width: 256,
                        margin: 2,
                        color: {
                            dark: '#000000',
                            light: '#ffffff'
                        },
                        errorCorrectionLevel: 'M'
                    }, function (error, canvas) {
                        if (error) {
                            console.error('‚ùå QR Code generation failed:', error);
                            qrContainer.innerHTML = '<div class="text-center p-3 text-danger"><i class="ri-error-warning-line fs-24"></i><br><small>Failed to generate QR code</small></div>';
                            showNotification('‚ùå Failed to generate QR code: ' + error.message, 'error');
                            testResults.qr = false;
                        } else {
                            console.log('‚úÖ QR Code generated successfully');
                            // Clear container and append canvas
                            qrContainer.innerHTML = '';
                            qrContainer.appendChild(canvas);
                            
                            // Also add to preview area
                            const previewArea = document.getElementById('qrPreview');
                            if (previewArea) {
                                const clonedCanvas = canvas.cloneNode(true);
                                previewArea.innerHTML = '<h6>QR Code Preview:</h6>';
                                previewArea.appendChild(clonedCanvas);
                            }
                            
                            // Show modal
                            const qrModalEl = document.getElementById('qrModal');
                            if (qrModalEl && typeof bootstrap !== 'undefined' && bootstrap.Modal) {
                                const qrModal = new bootstrap.Modal(qrModalEl);
                                qrModal.show();
                                showNotification('‚úÖ QR code generated successfully!', 'success');
                                testResults.qr = true;
                            } else {
                                console.error('‚ùå Bootstrap Modal not available');
                                showNotification('‚úÖ QR code generated, but modal display failed', 'warning');
                                testResults.qr = true; // Still counts as success
                            }
                        }
                    });
                } catch (qrError) {
                    console.error('‚ùå QR generation exception:', qrError);
                    qrContainer.innerHTML = '<div class="text-center p-3 text-danger"><i class="ri-error-warning-line fs-24"></i><br><small>QR generation failed</small></div>';
                    showNotification('‚ùå QR code generation error: ' + qrError.message, 'error');
                    testResults.qr = false;
                }
                
            } catch (error) {
                console.error('‚ùå QR code function failed:', error);
                showNotification('‚ùå Error generating QR code: ' + error.message, 'error');
                testResults.qr = false;
            }
        }

        // Download QR function (exact same as in referrals page)
        function downloadQR() {
            console.log('üìã Download QR clicked');
            try {
                const canvas = document.querySelector('#qrcode canvas');
                if (!canvas) {
                    console.error('‚ùå No QR code canvas found');
                    showNotification('‚ùå Error: No QR code to download. Please generate one first.', 'error');
                    return;
                }
                
                try {
                    const link = document.createElement('a');
                    const timestamp = new Date().toISOString().slice(0, 19).replace(/[T:]/g, '-');
                    link.download = `test-referral-qr-code-${timestamp}.png`;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    console.log('‚úÖ QR code download initiated');
                    showNotification('‚úÖ QR code downloaded successfully!', 'success');
                } catch (downloadError) {
                    console.error('‚ùå Download failed:', downloadError);
                    showNotification('‚ùå Download failed: ' + downloadError.message, 'error');
                }
            } catch (error) {
                console.error('‚ùå Download QR function failed:', error);
                showNotification('‚ùå Error downloading QR code: ' + error.message, 'error');
            }
        }

        // Test functions
        function testCopyFunction() {
            console.log('üß™ Testing copy function...');
            const result = document.getElementById('copyResult');
            result.innerHTML = '<strong>Testing copy function...</strong><br>';
            
            try {
                handleCopyLink();
                setTimeout(() => {
                    const success = testResults.copy !== false;
                    result.className = `test-result ${success ? 'success' : 'error'}`;
                    result.innerHTML += `<br><strong>Result:</strong> ${success ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                    result.innerHTML += `<strong>Details:</strong> Copy function ${success ? 'executed successfully' : 'failed to execute'}`;
                }, 1000);
            } catch (error) {
                result.className = 'test-result error';
                result.innerHTML += `<br><strong>Result:</strong> ‚ùå FAILED<br><strong>Error:</strong> ${error.message}`;
            }
        }

        function testWhatsAppFunction() {
            console.log('üß™ Testing WhatsApp function...');
            const result = document.getElementById('whatsappResult');
            result.innerHTML = '<strong>Testing WhatsApp share function...</strong><br>';
            
            try {
                shareOnWhatsApp();
                setTimeout(() => {
                    const success = testResults.whatsapp === true;
                    result.className = `test-result ${success ? 'success' : 'error'}`;
                    result.innerHTML += `<br><strong>Result:</strong> ${success ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                    result.innerHTML += `<strong>Details:</strong> WhatsApp URL ${success ? 'generated successfully' : 'failed to generate'}`;
                }, 500);
            } catch (error) {
                result.className = 'test-result error';
                result.innerHTML += `<br><strong>Result:</strong> ‚ùå FAILED<br><strong>Error:</strong> ${error.message}`;
            }
        }

        function testTelegramFunction() {
            console.log('üß™ Testing Telegram function...');
            const result = document.getElementById('telegramResult');
            result.innerHTML = '<strong>Testing Telegram share function...</strong><br>';
            
            try {
                shareOnTelegram();
                setTimeout(() => {
                    const success = testResults.telegram === true;
                    result.className = `test-result ${success ? 'success' : 'error'}`;
                    result.innerHTML += `<br><strong>Result:</strong> ${success ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                    result.innerHTML += `<strong>Details:</strong> Telegram URL ${success ? 'generated successfully' : 'failed to generate'}`;
                }, 500);
            } catch (error) {
                result.className = 'test-result error';
                result.innerHTML += `<br><strong>Result:</strong> ‚ùå FAILED<br><strong>Error:</strong> ${error.message}`;
            }
        }

        function testQRFunction() {
            console.log('üß™ Testing QR function...');
            const result = document.getElementById('qrResult');
            result.innerHTML = '<strong>Testing QR code generation...</strong><br>';
            
            try {
                generateQR();
                setTimeout(() => {
                    const success = testResults.qr === true;
                    result.className = `test-result ${success ? 'success' : 'error'}`;
                    result.innerHTML += `<br><strong>Result:</strong> ${success ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                    result.innerHTML += `<strong>Details:</strong> QR code ${success ? 'generated successfully' : 'failed to generate'}`;
                }, 2000);
            } catch (error) {
                result.className = 'test-result error';
                result.innerHTML += `<br><strong>Result:</strong> ‚ùå FAILED<br><strong>Error:</strong> ${error.message}`;
            }
        }

        function runAllTests() {
            console.log('üöÄ Running complete test suite...');
            const result = document.getElementById('allTestsResult');
            result.className = 'test-result info';
            result.innerHTML = '<strong>Running complete test suite...</strong><br><br>';
            
            // Reset test results
            testResults = { copy: null, whatsapp: null, telegram: null, qr: null };
            
            // Run all tests in sequence
            testCopyFunction();
            setTimeout(() => testWhatsAppFunction(), 1500);
            setTimeout(() => testTelegramFunction(), 2000);
            setTimeout(() => testQRFunction(), 2500);
            
            // Show final results
            setTimeout(() => {
                const passed = Object.values(testResults).filter(r => r === true).length;
                const total = Object.values(testResults).length;
                const success = passed === total;
                
                result.className = `test-result ${success ? 'success' : 'error'}`;
                result.innerHTML = `<strong>üß™ Test Suite Results:</strong><br><br>`;
                result.innerHTML += `üìã Copy Function: ${testResults.copy === true ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                result.innerHTML += `üí¨ WhatsApp Share: ${testResults.whatsapp === true ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                result.innerHTML += `‚úàÔ∏è Telegram Share: ${testResults.telegram === true ? '‚úÖ PASSED' : '‚ùå FAILED'}<br>`;
                result.innerHTML += `üî≤ QR Generation: ${testResults.qr === true ? '‚úÖ PASSED' : '‚ùå FAILED'}<br><br>`;
                result.innerHTML += `<strong>Overall: ${passed}/${total} tests passed (${Math.round(passed/total*100)}%)</strong>`;
            }, 5000);
        }

        // Simple notification function
        function showNotification(message, type = 'info') {
            console.log(`üì¢ [${type.toUpperCase()}] ${message}`);
            
            // Try to show in UI if possible
            const alertClass = type === 'success' ? 'alert-success' : 
                             type === 'error' ? 'alert-danger' : 'alert-info';
            
            // Create temporary notification
            const notification = document.createElement('div');
            notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.maxWidth = '400px';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // Display browser support information
        document.addEventListener('DOMContentLoaded', function() {
            const browserInfo = document.getElementById('browserInfo');
            browserInfo.innerHTML = `
                <strong>üìä Browser Compatibility:</strong><br>
                ‚Ä¢ Clipboard API: ${navigator.clipboard ? '‚úÖ Available' : '‚ùå Not available'}<br>
                ‚Ä¢ Secure Context (HTTPS): ${window.isSecureContext ? '‚úÖ Yes' : '‚ùå No (HTTP)'}<br>
                ‚Ä¢ execCommand: ${document.queryCommandSupported && document.queryCommandSupported('copy') ? '‚úÖ Supported' : '‚ùå Not supported'}<br>
                ‚Ä¢ QRCode Library: <span id="qrLibStatus">‚è≥ Loading...</span><br>
                ‚Ä¢ Bootstrap Modal: ${typeof bootstrap !== 'undefined' && bootstrap.Modal ? '‚úÖ Available' : '‚ùå Not available'}<br>
                ‚Ä¢ User Agent: ${navigator.userAgent.slice(0, 80)}...
            `;
            
            // Check QR library status
            setTimeout(() => {
                const qrStatus = document.getElementById('qrLibStatus');
                if (typeof QRCode !== 'undefined') {
                    qrStatus.innerHTML = '‚úÖ Loaded';
                    qrStatus.className = 'text-success';
                } else {
                    qrStatus.innerHTML = '‚ùå Failed to load';
                    qrStatus.className = 'text-danger';
                }
            }, 1000);
        });
    </script>
</body>
</html>